<?php
    ob_start();
    session_start();
    include("../INC/fonction.php");
    include("data.php");
    if(!isset($_SESSION['val'])){
        $val = 0;
    }
    else{
        $val = $_SESSION['val'];
    }
    $dept = getDepartments($data);
    $emp = getEmp($data,$val);

?>

<div class="container-fluid">  

    <div class="row p-3">

        <div class="col-md-12 m-3">
            <h5>Formulaire</h5>
        </div>

        <div class="col-md-3 m-3 bg-secondary rounded-3">

                <form action="../INC/traitement/traitement_formulaire.php" method="post">
                    <div class="col-md-12 m-3 p-3">

                            <div class="row-md-4 p-3">
                                <p>nom employ√© :</p>
                                <select name="employe" id="employe">
                                    <?php while($donnee2 = mysqli_fetch_assoc($emp)) { ?>
                                        <option value="<?= $donnee2['first_name'] ?>">
                                            <?= $donnee2['first_name'] ?>
                                        </option>
                                    <?php } ?>
                                </select>
                                <button><a href="../INC/traitement/traitement_formulaire.php?suivant=<?= $val + 20 ?>">suivant</a></button>
                                <button><a href="../INC/traitement/traitement_formulaire.php?precedent=<?= $val - 20 ?>">precedent</a></button>
                            </div>

                            <div class="row-md-4 p-3">
                                <p>departement :</p>
                                <select name="departement" id="departement">
                                    <?php while($donnee1 = mysqli_fetch_assoc($dept)) { ?>
                                        <option value="<?= $donnee1['dept_name'] ?>">
                                            <?= $donnee1['dept_name'] ?>
                                        </option>
                                    <?php } ?>
                                </select>
                            </div>

                            <div class="row-md-4 p-3">
                                <p>age min :</p>
                                <select name="agemin" id="agemin">
                                    <?php for($i=1;$i<100;$i++) { ?>
                                        <option value="<?= $i ?>">
                                            <?= $i ?>
                                        </option>
                                    <?php } ?>
                                </select>
                            </div>           

                            <div class="row-md-4 p-3">
                                <p>age max :</p>
                                <select name="agemax" id="agemax">
                                    <?php for($i=1;$i<100;$i++) { ?>
                                        <option value="<?= $i ?>">
                                            <?= $i ?>
                                        </option>
                                    <?php } ?>
                                </select>
                            </div>

                            <div class="row-md-4 p-3">
                                <input type="submit" value="valider">
                            </div>
                    
                    </div>
                </form>

        </div>

    </div>   

</div>

<?php
    $nav="ok";
    $contenu = ob_get_clean();
    include("html.php");
?>



///////////////////////////////////////////////////
<?php
    ob_start();
    session_start();
    include("../INC/fonction.php");
    include("data.php");
    $emp = $_SESSION['employe'];
    $dept = $_SESSION['departement'];
    $age_min = $_SESSION['agemin'];
    $age_max = $_SESSION['agemax'];

    if(!isset($_SESSION['num_Emp'])){
        $val = 0;
    }
    else{
        $val = $_SESSION['num_Emp'];
    }

    $page = getResult_NbEmployees($data,$emp,$dept,$age_max,$age_min);
    $result = getResult_Employees($data,$emp,$dept,$age_max,$age_min,$val);
    $end_page = $page - $val;
?>

<?php
    while($donnee = mysqli_fetch_assoc($result)) { 
?>
    <p>
        Nom : <?= $donnee['first_name'] ?> <?= $donnee['last_name'] ?><br>
        Emploi : <?= $donnee['title'] ?>
    </p>
<?php
    }
?>
    <?php if($val < $page && $val != $end_page) { ?>
    <button><a href="../INC/traitement/traitement_page.php?suivant=<?= $val + 20 ?>">suivant</a></button>
    <?php } ?>

    <?php if($val != 0) { ?>
    <button><a href="../INC/traitement/traitement_page.php?precedent=<?= $val - 20 ?>">precedent</a></button>
    <?php } ?>

<?php
    $nav="ok";
    $contenu = ob_get_clean();
    include("html.php");
?>